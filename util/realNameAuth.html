<!DOCTYPE html>
<html>
<head>
    <title>实名认证</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsencrypt/3.1.0/jsencrypt.min.js"></script>
    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const privateKeyInput = document.getElementById('privateKey');
            const form = document.getElementById('verificationForm');
            const signatureInput = document.getElementById('signature');
            form.action = 'http://123.56.121.72:5000/RealNameAuth';

            form.addEventListener('submit', (event) => {
                event.preventDefault();

                const privateKey = privateKeyInput.value;
                const nickname = document.getElementById('nickname').value;
                const fullName = document.getElementById('fullName').value;
                const idNumber = document.getElementById('idNumber').value;

                const dataToSign = fullName+ idNumber;
                const encrypt = new JSEncrypt();
                encrypt.setPrivateKey(privateKey);
                const signature = encrypt.encrypt(dataToSign, 'sha256');

                signatureInput.value = signature;
                form.submit();
            });
        });
    </script>
</head>
<body>
    <h1>实名认证</h1>
    <label for="privateKey">RSA私钥（不会提交给服务器）：</label>
        <textarea name="privateKey" id="privateKey" rows="4" cols="50" required></textarea>
    <form id="verificationForm"  method="POST">
        <label for="nickname">昵称：</label>
        <input type="text" name="nickname" id="nickname" required>

        <label for="fullName">真实姓名：</label>
        <input type="text" name="fullName" id="fullName" required>

        <label for="idNumber">身份证号码：</label>
        <input type="text" name="idNumber" id="idNumber" required>

        <input type="hidden" name="signature" id="signature">

        <input type="submit" value="提交">
    </form>
</body>
</html>
